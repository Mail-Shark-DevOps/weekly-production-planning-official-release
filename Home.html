<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>Weekly Production Planning Excel Add-In</title>

    <script src="Scripts/MessageBanner.js" 
            type="text/javascript"></script>

    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" 
            type="text/javascript"></script>

    <link rel="stylesheet" 
          href="./tabulator_bulma.css" 
          type="text/css" />

    <link href="https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css"
          rel="stylesheet">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" 
          rel="stylesheet">

    <link href="Home.css" 
          rel="stylesheet" 
          type="text/css" />

    <link href="./Content/Button.css" 
          rel="stylesheet" 
          type="text/css" />

    <link href="./Content/MessageBanner.css" 
          rel="stylesheet" 
          type="text/css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" 
            type="text/javascript"></script>

    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.4.4/js/tabulator.min.js" 
            integrity="sha512-BGo9xGWI32ZfTMp/ueR3fZKO5nYkPbt3uwMWr+w8w3e72H8A0sTQGO+iqRADwIT0eJkFP1HDgSC82gA4sTuQ6w==" 
            crossorigin="anonymous" 
            referrerpolicy="no-referrer"></script>

    <link rel="icon" 
          href="data:;base64,iVBORw0KGgo=">

</head>


<body class="ms-Fabric" dir="ltr">
    <!-- <button id="doIt">ugh</button> -->
    <div id="header" class="zoom-title">

        <div id="main-title-head" class="title-head">
            <div id="title-head">
                <img id="heading-logo" src="./Images/logo-filled.png" alt="Welcome" title="Welcome" />
                <span id="page-title" class="underline">PRESS SCHEDULING</span>
            </div>
        </div>

    </div>





    <div id="welcome-page">

        <header class="welcome-header ms-bgColor-neutralLighter">

            <div id="welcome-header-section" class="zoom-head">
                <img width="90" height="90" src="./Images/logo-filled.png" alt="Welcome" title="Welcome" />
                <h1 class="center welcome-pad">Weekly Production Planning</h1>
            </div>


            <div id="cover-image" class="zoom-head"></div>

            <div id="sub-text" class="zoom-head">
                <p class="ms-font-xl top-sub-text">If you are seeing this screen, then there is no form data logged to enable Press Scheduling.</p>
                <p class="ms-font-l">To get started, please paste in your info to the proper areas and click <b>Populate Forms</b>.</p>
            </div>

            <!--<div id="bottom">
                <div id="footer">
                    <div class="text-box">
                        <a id="populate-forms" href="#" class="btn btn-purple btn-animate">Populate Forms</a>
                    </div>
                    <div class="text-box">
                        <a id="breakout" href="#" class="btn btn-blue btn-animate">Breakout</a>
                    </div>
                </div>

                <div id="absolute-bottom">
                    <p id="version">Version 1.3.6 - Created by Matt Calvert</p>
                </div>
            </div>-->
            <!-- <hr> -->
        </header>


    </div>




    <div id="select-tables" class="zoom">

        <div id="silk-table" class="assign-values btm-space">

            <h4 class="silk-head">SILK</h4>
            <div class="border-box silk-border">
                <div id="silk-form" class="fill-out"></div>
            </div>

        </div>

        <div id="text-table" class="assign-values btm-space">

            <h4 class="text-head">TEXT</h4>
            <div class="border-box text-border">
                <div id="text-form" class="fill-out">
                </div>
            </div>

        </div>

        <div id="digital-table" class="assign-values btm-space">

            <h4 class="dig-head">DIGITAL</h4>
            <div class="border-box dig-border">
                <div id="dig-form" class="fill-out">
                </div>
            </div>

        </div>

        <div id="clearall">
            <span id="clearall-butt" role="button" class="small-butt">Clear All Data</span>
        </div>

    </div>



    <div id="week-tables" class="assign-values to-top stat-table-area zoom">

        <div id="handle" class="ui-resizable-handle ui-resizable-n">
            <i class="fa-solid fa-grip-lines"></i>
        </div>

        <div id="scroll-this" class="unselectable">

            <div id="week-table-head" class="dow-head">
                <div id="head-title">
                    <i id="dow-left-arrow" value="back" class="fa-solid fa-chevron-left dow-arrow"></i>
                    <span id="week-title" class="underline">MONDAY</span>
                    <i id="dow-right-arrow" value="forward" class="fa-solid fa-chevron-right dow-arrow"></i>
                </div>
            </div>

            <div id="dow-dots" class="nav-dots" style="margin-bottom: 15px">
                <!-- dots go here -->
                <i weekday="monday" class="fa-solid fa-circle fa-2xs dots week-dots dot-selected"></i>
                <i weekday="tuesday" class="fa-solid fa-circle fa-2xs dots week-dots"></i>
                <i weekday="wednesday" class="fa-solid fa-circle fa-2xs dots week-dots"></i>
                <i weekday="thursday" class="fa-solid fa-circle fa-2xs dots week-dots"></i>
                <i weekday="friday" class="fa-solid fa-circle fa-2xs dots week-dots"></i>
            </div>

            <div id="html-tables">

                <div id="monday-static" class="current-week show-table">
                    <div id="monday-form" class="fill-out">
                        <table>
                        </table>
                    </div>
                </div>

                <div id="tuesday-static" class="current-week">
                    <div id="tuesday-form" class="fill-out">
                        <table>
                        </table>
                    </div>
                </div>

                <div id="wednesday-static" class="current-week">
                    <div id="wednesday-form" class="fill-out">
                        <table>
                        </table>
                    </div>
                </div>

                <div id="thursday-static" class="current-week">
                    <div id="thursday-form" class="fill-out">
                        <table>
                        </table>
                    </div>
                </div>

                <div id="friday-static" class="current-week">
                    <div id="friday-form" class="fill-out">
                        <table>
                        </table>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <div id="format-background" class="background">
        <div id="format-window" class="warning">
            <h1>Breakout Sheets Title</h1>
            <p>The following data fields will be added to the beginning of each of the breakout sheets title area.</p>
            <label for="group" id="grouplabel">Group</label>
            <input id="group" type="text">

            <label for="print">Print Date</label>
            <input id="print" type="text">

            <label for="week">Week</label>
            <input id="week" type="text">

            <label for="inkstart">Ink Start</label>
            <input id="inkstart" type="text">

            <label for="inkend">Ink End</label>
            <input id="inkend" type="text">

            <label for="msweek">MS Week</label>
            <input id="msweek" type="text">

            <label for="preview">Preview</label>
            <textarea id="preview" disabled></textarea>
            <div class="one-button">
                <button id="format-btn" class="alt-btn">Go</button>
            </div>
        </div>
    </div>

    <div id="report-background" class="background">
        <div id="report-window" class="warning">
            <h1>Thank you!</h1>
            <p>Your report has been successfully sent to DevOps. We will get back to you shortly.</p>
            <div class="two-buttons">
                <button id="err-reload2" class="alt-btn">Reload</button>
            </div>
        </div>
    </div>

    <div id="err-background" class="background">
        <div id="err-warning" class="warning">
            <h1>ERROR</h1>
            <p>Oops. Something went wrong. Please either reload the add-in or click "Report" to automatically send a ticket to DevOps.</p>
            <div id="error-message" class="err-scroll" style="display: none;"></div>
            <label for="reportEmail">If you would like to report this error, please input your Mail Shark employee email below and click "Report".</label>
            <input type="email" id="reportEmail" placeholder="user@themailshark.com">
            <br>
            <label for="brief">A brief explanation of what happened (Optional):</label>
            <textarea id="brief"></textarea>
            <hr>

            <div class="two-buttons">
                <button id="err-reload" class="alt-btn">Reload</button>
                <button id="err-report" class="alt-btn" disabled>Report</button>
            </div>
        </div>
    </div>

    <div id="missing-forms-background" class="background">
        <div id="missing-forms-warning" class="warning">
            <!-- Reads grammatically incorrect, but this will change depending on how many forms are missing. -->
            <p>There <span id="missing-list"></span> missing on the Master worksheet.</p>
            <p>Missing Forms: </p>
            <div id="missing-scroll" class="err-scroll">
                <ul id="missing-roster">
                    <!-- Will be populated. -->
                </ul>
            </div>
            <hr>
            <div class="one-button">
                <button id="hide-missing" class="alt-btn">OK</button>
            </div>
        </div>
    </div>


    <div id="missing-product-types-background" class="background">

        <div id="product-type-warning" class="warning">

            <h1>WARNING</h1>
            <p>The following products in the master sheet do not have any associated breakout type in the Validation sheet:</p>
            <div class="err-scroll smaller-scroll">
                <ul id="missing-prod-type-list"></ul>
            </div>

            <p>Below are all the rows in the master table that are missing type values because of this:</p>
            <div class="err-scroll smaller-scroll">
                <ul id="missing-prod-type-row-list"></ul>
            </div>
            <hr>
            <p>Please make sure to assign a proper breakout line for each of the missing types in the rows above before clicking "Breakout"</p>
            <div class="one-button">
                <button id="hide-missing-prod-type" class="alt-btn">OK</button>
            </div>

        </div>

    </div>

    <div id="reset-background" class="background">
        <div id="reset-warning" class="warning">
            <h1>WARNING</h1>
            <p>By clicking "Reset", you will remove all changes made to the document, including all press scheduling data and any changes made to the master sheet and/or breakout sheets. Are you sure you want to do this?</p>
            <div id="reset-buttons" class="two-buttons">
                <button id="reset-forms" class="alt-btn">Reset</button>
                <button id="no" class="alt-btn">Cancel</button>
            </div>
        </div>
    </div>


    <div id="empty-background" class="background">

        <div id="empty-warning" class="warning">

            <h1>WARNING</h1>
            <p>Empty cells in "Type" column prevent breakout sheets. UJID list below:</p>
            <div class="err-scroll">
                <ul id="empty-ujid"></ul>
            </div>

            <p>Set all records to "All Other" to continue, or click "Handle Manually" to update.</p>
            <div id="empty-buttons" class="two-buttons">
                <button id="set-to-ignore" class="alt-btn">All Other Override</button>
                <button id="handle-manually" class="alt-btn">Handle Manually</button>
            </div>

        </div>

    </div>


    <div id="loading-background" class="background">
        <div id="loading-section" class="warning">
            <h1 id="loading-head">Creating Breakout Tables</h1>
            <p>This should only take a few moments...</p>
        </div>
    </div>


    <div id="footer">
        <div class="text-box">
            <a id="populate-forms" href="#" class="btn btn-purple btn-animate">Populate Forms</a>
        </div>
        <div class="text-box">
            <a id="breakout" href="#" class="btn btn-blue btn-animate">Breakout</a>
        </div>
    </div>

    <div id="absolute-bottom">
        <p id="version">Version 1.5.6 - Created by Matt Calvert</p>
    </div>

    <!--bleh-->



    <script src="Home.js" type="module"></script>


</body>
</html>
